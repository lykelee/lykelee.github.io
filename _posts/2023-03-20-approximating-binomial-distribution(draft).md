---
title: "이항 분포(Binomial distribution)를 근사하는 방법"
categories:
  - Mathematics
tags:
  - Mathematics
  - Probability Theory
  - Binomial Distribution
  - Normal Distribution
  - Poisson Distribution
---

## 이항 분포의 근사가 필요한 이유

이항 분포는 자주 사용되는 분포이지만 일반적으로 계산이 힘들다는 문제가 있다.
이항 분포의 확률값을 구하기 위해 ${n \choose k} = \frac{n!}{k!(n-k)!}$를 계산해야 하며, 이는 시행 횟수 $n$이 증가할수록 급격히 어려워진다.
이항 분포를 근사하는 데 사용되는 정규분포와 푸아송 분포는 큰 $n$에 대해 이항 분포보다 확률값을 계산하기 쉽기 때문에 근사하는 용도로 사용될 수 있다.

## 정규분포(Normal distribution)

정규분포(normal distribution) 또는 가우시안 분포(Gaussian distribution)는 가장 기본적인 확률 분포 중 하나이다.
정규분포의 가장 중요한 특성은, 표본이 따르는 확률 분포의 종류에 관계없이 표본의 수가 커질수록 표본들의 평균의 분포는 정규분포로 가까워진다는 것이다. 이를 중심극한정리(Central Limit Theorem, CLT)라고 한다.

이항 분포의 경우 베르누이 분포를 따르는 독립적인 확률변수 $n$개를 더한 값의 분포와 같으므로 중심극한정리가 적용된다.
따라서 이항 분포 역시 정규분포로 근사할 수 있다.
이항 분포의 평균은 $np$, 분산은 $np(1-p)$이므로, 정규분포 $\mathcal{N}(np, np(1-p))$에 수렴하게 된다.
당연히 $n$이 커질수록 두 분포 간의 차이가 작아지게 되어 오차가 작아진다.

정규분포 근사 시 주의해야 할 점으로, 이항 분포는 이산확률분포인 반면 정규분포는 연속확률분포라는 것이다.
???
Continuity correction

Anderson, D. F., Seppäläinen, T., & Valkó, B. (2017). Introduction to Probability. Cambridge University Press.에 의하면, 이항 분포의 분산인 $np(1-p)$가 10보다 클 경우 정규분포 근사의 결과가 좋다고 한다.

## 푸아송 분포(Poisson distribution)

푸아송 분포(Poisson distribution)는

> 단위 시간동안 어떤 사건이 일어날 횟수의 기댓값이 $\lambda$일 때, 

마치 유한한 구간으로 나누어진 리만 합들의 (엄밀한 표현은 아니지만)극한이 리만 적분이 되는 것과 유사하다.

푸아송 분포에 관한 좋은 글들:
https://danbi-ncsoft.github.io/study/2019/07/15/poisson.html


푸아송 분포의 경우 확률값에서 $n$에 따라 변하는 값은 $\lambda^n$과 $n!$이다. 이 역시 $n$이 증가할수록 계산이 어려워지지만, 이항 분포보다는 확실히 쉽다.

정규분포와 마찬가지로, 푸아송 분포 역시 이항 분포를 잘 근사하기 위해서는 조건이 필요하다.
정규분포와는 반대로, 푸아송 분포는 $n$이 크고 $p$가 작을수록 근사의 정확성이 올라간다.
이 사실은 푸아송 분포의 의미를 생각하면 매우 직관적이다. 이항 분포를 푸아송 분포로 근사하는 것은 기댓값인 $np$는 유지하되 $n$과 $p$이 각각 무한대와 0으로 가도록 극한을 취하는 것과 같다. 따라서 원래 이항 분포의 $n$이 크고 $p$가 작을수록 극한인 푸아송 분포와의 차이가 작아지게 된다.

위 생각을 뒷받침하는 엄밀한 근거로 [Poisson limit theorem](https://en.wikipedia.org/wiki/Poisson_limit_theorem)이 있다. 이 정리는 전술한 것과 동일하게 이항 분포에서 기댓값 $np$를 고정하고 $n$을 무한대로 가도록 극한을 취하면 푸아송 분포로 수렴함을 알려준다. 언뜻 보면 $n$이 무한대로 가면 임의의 분포가 정규분포로 수렴한다는 중심극한정리와 충돌하는 것처럼 보인다. 그러나 이 경우 $n$이 변함에 따라 $p$ 역시 변하여 분포가 달라지므로 중심극한정리의 적용 대상이 아니다. 중심극한정리가 적용되려면 이항 분포의 각 시행인 베르누이 시행의 분포가 일정해야 하므로 $p$가 고정된 값이어야 함을 유의해야 한다.

다음 정리는 푸아송 근사의 정확성에 대해 보다 정밀한 정보를 제공한다.

> $X \sim \textrm{Bin} (n, p), Y \sim \textrm{Poisson} (np)$일 때, 모든 사건 $A$에 대하여 $|P(X \in A) - P(Y \in A)| \leq np^2$가 성립한다.\
출처: Anderson, D. F., Seppäläinen, T., & Valkó, B. (2017). Introduction to Probability. Cambridge University Press.

이 정리에 따르면 푸아송 근사로 구한 확률값의 오차는 최대 $np^2$이다. 따라서 이 값이 충분히 작다면 푸아송 근사의 정확성이 보장된다. 반면 이 값이 작지 않다면 정확성이 보장되지 않아 근사가 정확하지 않을 수 있다. $np^2$은 $0$부터 $1$ 사이의 확률값에 대한 오차의 상계이므로, $1$보다 확실히 작아야 정확성이 보장됨을 유의해야 한다.

## 두 방법들 간의 비교

우선 두 방법 모두 시행 횟수 $n$이 증가할수록 근사가 잘 된다는 공통점이 있다. 그러나 정규분포의 경우 $p$가 $1/2$에 가까울수록 유리한 반면 푸아송 분포는 $p$가 $0$에 가까울수록 유리하다.
따라서 상황에 따라 두 분포 중 적절한 것을 선택하면 된다.
두 근사 모두 사용하기 어려운 경우는 대개 $n$이 작을 것이므로 근사 없이 계산이 가능한 경우가 많을 것이다.

## 예제

직접 계산하는 것이 어려운 이항 분포의 확률값이 주어지고, 이를 정규분포 또는 푸아송 분포 중 하나로 적절히 근사하여 계산하는 문제들이다.

### 예제 1

### 예제 3

문제: $X \sim \mathrm{Bin} (100, 0.99)$일 때, $P(X = 98)$을 구해라.

풀이: $np(1-p) = 100 * 0.99 * 0.01 = 0.99$로 $10$보다 크지 않아 정규분포 근사를 사용하기는 힘들다. 또한 $np^2 = 100 * 0.99^2 = 98.01$로 푸아송 근사는 사용할 수 없다. 그러면 어떻게 근사를 할 수 있을까?

$X$는 $100$번 성공하였을 때 성공의 횟수를 의미한다. 그렇다면 성공 횟수 대신 실패 횟수를 생각하면 어떨까? 실패 횟수를 나타내는 확률변수를 $Y$라고 하자. 그러면 $P(X = 98) = P(Y = 2)$이다. 또한 $Y$는 $0.01$의 확률의 베르누이 시행을 $100$번 하는 것과 같으므로 $Y \sim \mathrm{Bin} (100, 0.01)$이다.
이제 $Y$는 푸아송 근사를 사용할 수 있을 만큼 충분히 $p$가 작다. $np^2 = 100 * 0.01^2 = 0.01$로 충분히 작다. 따라서 푸아송 근사를 $Y$에 적용하여 $P(Y = 2)$를 구함으로써 $P(X = 98)$을 구할 수 있다.

푸아송 근사로 계산한 확률은 $e^{-1} 1^2 / 2! \approx 0.183940$이다. 이는 실제 확률인 ${100 \choose 98} 0.99^{98} 0.01^2 \approx 0.184865$와 크게 차이나지 않는다. 반면 정규분포 근사를 사용하는 경우 $P(\frac{-1.5}{\sqrt{0.99}} \le Z \le \frac{-0.5}{\sqrt{0.99}}) \approx 0.03988$로 그리 정확하지 않다.
